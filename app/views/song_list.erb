<h3>
  <%= user_link @user['username'] , @user['screenname'] %> さんの楽曲一覧 
  (<% if @filter_word %>検索結果: <% else %>全<% end %><%= @song_list[:num] %> 曲)
</h3>

<%= erb :_pager %>

<form method="GET">
  <label for="filter">絞込み</label>
  <select id="filter_category" name="filter_category">
    <option value="song" <% if @filter_category == "song" %> selected <% end %>>曲名</option>
    <option value="artist" <% if @filter_category == "artist" %> selected <% end %>>アーティスト名</option>
    <option value="tag" <% if @filter_category == "tag" %> selected <% end %>>タグ名</option>
  </select>
  <input type="text" size="20" placeholder="絞込みワード" id="filter_word" name="filter_word" value="<%= @filter_word %>">

  <label>並び順</label>
  <select id="sort" name="sort">
    <option value="create_a">登録順(昇順)</option>
    <option value="create_b">登録順(降順)</option>
    <option value="song_a">曲名順(昇順)</option>
    <option value="song_d">曲名順(降順)</option>
    <option value="artist_a">アーティスト名順(昇順)</option>
    <option value="artist_d">アーティスト名順(降順)</option>
    <option value="sangcount_a">歌唱回数順(昇順)</option>
    <option value="sangcount_d">歌唱回数順(降順)</option>
    <option value="lastsang_a">最近歌った楽曲(昇順)</option>
    <option value="lastsang_d">最近歌った楽曲(降順)</option>
  </select>

  <label>表示件数</label>
  <select id="pagenum" name="pagenum">
    <option value="24" <% if @pagenum == 24 %> selected <% end %>>24</option>
    <option value="48" <% if @pagenum == 48 %> selected <% end %>>48</option>
    <option value="72" <% if @pagenum == 72 %> selected <% end %>>72</option>
    <option value="96" <% if @pagenum == 96 %> selected <% end %>>96</option>
    <option value="120" <% if @pagenum == 120 %> selected <% end %>>120</option>
  </select>

  <% csrftoken %>
  <input type="submit" value="表示">
</form>

<table id="song_list_table" class='table'>
  <tbody>
    <% @song_list[:list].each_with_index do |song , idx| %>
      <% if idx % 2 == 0 %>
      <tr>
      <% end %>
        <td id="thumbnail_<%= idx %>" class='center' width='20%'>
          <% if song['song_url'] %>
          <span id="song_name_<%= idx %>" class="hidden"><%= song["song_name"] %></span>
          <span id="artist_name_<%= idx %>" class="hidden"><%= song["artist_name"] %></span>
          <script>
          zenra.createThumbnail(
            "<%= idx %>" ,
            "<%= song['song_id'] %>" ,
            "<%= youtube_image song['song_url'] %>" ,
            "100%",
            "auto"
          );
          </script>
          <% else %>
          未登録
          <% end %>
        </td>
        <td width='30%'>
          <p><%= song_link song['song_id'] , song['song_name'] %></p>
          <p><%= artist_link song['artist_id'] , song['artist_name'] %></p>
          <p class="mini">歌唱回数: <%= song['sang_count'] %></p>
          <p class="mini">最終歌唱日: <a href="/karaoke/detail/<%= song['last_sang_karaoke'] %>"><%= song['last_sang_datetime'] %></a></p>
        </td>
      <% if idx + 1 % 2 == 0 %>
      </tr>
      <% end %>
    <% end %>
  </tbody>
</table>

<%= erb :_pager %>
